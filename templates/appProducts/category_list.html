{% extends "base.html" %}
{% load static %}

{% block title %}–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤ ‚Äî Clean Store{% endblock %}

{% block content %}
<div class="catalog-page">
    <div class="container">
        <!-- –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏ -->
        <nav class="breadcrumb">
            <a href="{% url 'home' %}" class="breadcrumb-link">–ì–ª–∞–≤–Ω–∞—è</a>
            <span class="breadcrumb-separator">‚Üí</span>
            <span class="breadcrumb-current">–ö–∞—Ç–∞–ª–æ–≥</span>
        </nav>

        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
        <div class="page-header">
            <h1 class="page-title">–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</h1>
            <p class="page-subtitle">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–æ–≤–∞—Ä–æ–≤</p>
            <div class="page-actions">
                <a href="{% url 'appProducts:all_products' %}" class="btn btn-primary">
                    üõçÔ∏è –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã
                </a>
            </div>
        </div>

        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ -->
        {% if search_query %}
        <div class="search-results-section">
            <div class="search-results-header">
                <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞: "{{ search_query }}"</h2>
                <p>–ù–∞–π–¥–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: {{ search_count }}</p>
            </div>
            
            {% if search_results %}
                <div class="search-products-grid">
                    {% for product in search_results %}
                        <div class="product-card catalog-card">
                            <a href="{% url 'appProducts:product_detail' product.subcategory.category.slug product.subcategory.slug product.slug %}" class="category-link-full">
                                <div class="category-image-container">
                                    {% if product.main_image %}
                                        <img src="{{ product.main_image.url }}" alt="{{ product.name }}" class="category-image">
                                    {% else %}
                                        <div class="category-placeholder">
                                            <span class="placeholder-emoji">üßπ</span>
                                            <div class="placeholder-text">
                                                –ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                                                <br><small>—Ç–æ–≤–∞—Ä–∞</small>
                                            </div>
                                        </div>
                                    {% endif %}
                                    
                                    <!-- –ë–µ–π–¥–∂–∏ -->
                                    <div class="product-badges">
                                        {% if product.is_new %}
                                            <span class="product-badge new">–ù–æ–≤–∏–Ω–∫–∞</span>
                                        {% endif %}
                                        {% if product.is_hit %}
                                            <span class="product-badge hit">–•–∏—Ç</span>
                                        {% endif %}
                                        {% if product.is_sale %}
                                            <span class="product-badge sale">–°–∫–∏–¥–∫–∞</span>
                                        {% endif %}
                                    </div>
                                </div>
                                
                                <div class="category-content">
                                    <h3 class="category-title">{{ product.name }}</h3>
                                    <p class="category-description">{{ product.subcategory.category.title }} ‚Üí {{ product.subcategory.title }}</p>
                                    <div class="category-meta">
                                        <div class="product-price">{{ product.price }}</div>
                                        <div class="category-action">
                                            <span class="category-btn">
                                                –ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Üí
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </a>
                            
                            <div class="product-actions">
                                {% if user.is_authenticated %}
                                    <form method="post" action="{% url 'appProducts:add_to_cart' product.id %}" class="add-to-cart-form">
                                        {% csrf_token %}
                                        <input type="hidden" name="quantity" value="1">
                                        <button type="submit" class="btn btn-primary btn-sm">
                                            üõí –í –∫–æ—Ä–∑–∏–Ω—É
                                        </button>
                                    </form>
                                {% else %}
                                    <a href="{% url 'login' %}" class="btn btn-secondary btn-sm">
                                        –í–æ–π—Ç–∏ –¥–ª—è –ø–æ–∫—É–ø–∫–∏
                                    </a>
                                {% endif %}
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="no-results">
                    <div class="no-results-icon">üîç</div>
                    <h3>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
                    <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å</p>
                </div>
            {% endif %}
        </div>
        {% endif %}

        <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
        <section class="catalog-categories">
            <div class="categories-grid">
                {% for category in categories %}
                    <div class="category-card catalog-card">
                        <a href="{% url 'appProducts:subcategory_list' category.slug %}" class="category-link-full">
                            <div class="category-image-container">
                                {% if category.image %}
                                    <img src="{{ category.image.url }}" alt="{{ category.title }}" class="category-image">
                                {% else %}
                                    <div class="category-placeholder">
                                        {% if '—Å–±–æ—Ä–∞' in category.title|lower or '–æ—Ç—Ö–æ–¥' in category.title|lower %}
                                            <span class="placeholder-emoji">üóëÔ∏è</span>
                                        {% elif '—Å–∏–∑' in category.title|lower or '–∑–∞—â–∏—Ç' in category.title|lower %}
                                            <span class="placeholder-emoji">ü¶∫</span>
                                        {% elif '—Ö–∏–º–∏—è' in category.title|lower or '–ø—Ä–æ—Ñ–µ—Å—Å' in category.title|lower %}
                                            <span class="placeholder-emoji">üß™</span>
                                        {% elif '–∏–Ω–≤–µ–Ω—Ç–∞—Ä—å' in category.title|lower or '–∞–∫—Å–µ—Å—Å—É–∞—Ä' in category.title|lower %}
                                            <span class="placeholder-emoji">üßπ</span>
                                        {% elif '—Å—Ç–∏—Ä–∫' in category.title|lower or '–±–µ–ª—å' in category.title|lower %}
                                            <span class="placeholder-emoji">üß∫</span>
                                        {% elif '—É–±–æ—Ä–∫' in category.title|lower %}
                                            <span class="placeholder-emoji">üßΩ</span>
                                        {% else %}
                                            <span class="placeholder-emoji">üßπ</span>
                                        {% endif %}
                                        <div class="placeholder-text">
                                            –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ<br>
                                            <small>—á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É</small>
                                        </div>
                                    </div>
                                {% endif %}
                            </div>
                            <div class="category-content">
                                <h3 class="category-title">{{ category.title }}</h3>
                                {% if category.description %}
                                    <p class="category-description">{{ category.description|truncatewords:10 }}</p>
                                {% endif %}
                                <div class="category-meta">
                                    <span class="subcategories-count">
                                        {{ category.subcategories.count }} –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π
                                    </span>
                                    <div class="category-action">
                                        <span class="category-btn">
                                            –ü–µ—Ä–µ–π—Ç–∏ ‚Üí
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </a>
                    </div>
                {% empty %}
                    <div class="empty-state">
                        <div class="empty-icon">üßπ</div>
                        <h3>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã</h3>
                        <p>–ú—ã —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞–¥ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∫–∞—Ç–∞–ª–æ–≥–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–π—Ç–∏ –ø–æ–∑–∂–µ.</p>
                        <a href="{% url 'home' %}" class="btn btn-primary">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
                    </div>
                {% endfor %}
            </div>
        </section>

        <!-- –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã -->
        <section class="popular-products">
            <h2 class="section-title">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</h2>
            <div class="products-grid">
                <!-- –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã -->
                <div class="product-placeholder">
                    <div class="placeholder-icon">üî•</div>
                    <p>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å</p>
                </div>
            </div>
        </section>

        <!-- –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ -->
        <section class="catalog-features">
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">üöö</div>
                    <h3>–ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞</h3>
                    <p>–î–æ—Å—Ç–∞–≤–∏–º –∑–∞–∫–∞–∑ –≤ —Ç–µ—á–µ–Ω–∏–µ 1-3 –¥–Ω–µ–π</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üí∞</div>
                    <h3>–í—ã–≥–æ–¥–Ω—ã–µ —Ü–µ–Ω—ã</h3>
                    <p>–õ—É—á—à–∏–µ —Ü–µ–Ω—ã –Ω–∞ —Ä—ã–Ω–∫–µ</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">‚úÖ</div>
                    <h3>–ì–∞—Ä–∞–Ω—Ç–∏—è –∫–∞—á–µ—Å—Ç–≤–∞</h3>
                    <p>–¢–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üîÑ</div>
                    <h3>–õ–µ–≥–∫–∏–π –≤–æ–∑–≤—Ä–∞—Ç</h3>
                    <p>–í–µ—Ä–Ω–µ–º –¥–µ–Ω—å–≥–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 14 –¥–Ω–µ–π</p>
                </div>
            </div>
        </section>
    </div>
</div>
{% endblock %}