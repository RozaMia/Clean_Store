{% extends "base.html" %}
{% load static %}

{% block title %}{{ product.name }} ‚Äî Clean Store{% endblock %}

{% block content %}
<div class="product-detail-page">
    <div class="container">
        <!-- –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏ -->
        <nav class="breadcrumb">
            <a href="{% url 'home' %}" class="breadcrumb-link">–ì–ª–∞–≤–Ω–∞—è</a>
            <span class="breadcrumb-separator">‚Üí</span>
            <a href="{% url 'appProducts:category_list' %}" class="breadcrumb-link">–ö–∞—Ç–∞–ª–æ–≥</a>
            <span class="breadcrumb-separator">‚Üí</span>
            <a href="{% url 'appProducts:subcategory_list' product.subcategory.category.slug %}" class="breadcrumb-link">
                {{ product.subcategory.category.title }}
            </a>
            <span class="breadcrumb-separator">‚Üí</span>
            <a href="{% url 'appProducts:product_list' product.subcategory.category.slug product.subcategory.slug %}" class="breadcrumb-link">
                {{ product.subcategory.title }}
            </a>
            <span class="breadcrumb-separator">‚Üí</span>
            <span class="breadcrumb-current">{{ product.name }}</span>
        </nav>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ -->
        <div class="product-detail-hero">
            <div class="product-hero-content">
                <div class="product-gallery-section">
                    <div class="main-image-container">
                        {% if product.main_image %}
                            <img src="{{ product.main_image.url }}" alt="{{ product.name }}" class="main-product-image">
                        {% else %}
                            <div class="product-image-placeholder">
                                <span class="placeholder-emoji">üßΩ</span>
                                <div class="placeholder-text">
                                    –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
                                    <br><small>—Å–∫–æ—Ä–æ –ø–æ—è–≤–∏—Ç—Å—è</small>
                                </div>
                            </div>
                        {% endif %}
                        
                        <!-- –°—Ç–∏–ª—å–Ω—ã–µ –±–µ–π–¥–∂–∏ -->
                        <div class="product-status-badges">
                            {% if product.is_new %}
                                <span class="status-badge new">
                                    <span class="badge-icon">‚ú®</span>
                                    <span class="badge-text">–ù–æ–≤–∏–Ω–∫–∞</span>
                                </span>
                            {% endif %}
                            {% if product.is_hit %}
                                <span class="status-badge hit">
                                    <span class="badge-icon">üî•</span>
                                    <span class="badge-text">–•–∏—Ç</span>
                                </span>
                            {% endif %}
                            {% if product.is_sale %}
                                <span class="status-badge sale">
                                    <span class="badge-icon">üí∞</span>
                                    <span class="badge-text">–°–∫–∏–¥–∫–∞</span>
                                </span>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- –ì–∞–ª–µ—Ä–µ—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–æ—Ç–æ -->
                    {% if extra_images %}
                        <div class="product-gallery-thumbnails">
                            <h4>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ</h4>
                            <div class="thumbnails-grid">
                                {% for img in extra_images %}
                                    <div class="thumbnail-item">
                                        <img src="{{ img.image.url }}" alt="–§–æ—Ç–æ {{ forloop.counter }}" class="thumbnail-image">
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    {% endif %}
                </div>

                <div class="product-info-section">
                    <div class="product-header-modern">
                        <div class="product-category-path">
                            <span class="category-link">{{ product.subcategory.category.title }}</span>
                            <span class="path-separator">‚Üí</span>
                            <span class="subcategory-link">{{ product.subcategory.title }}</span>
                        </div>
                        <h1 class="product-title-modern">{{ product.name }}</h1>
                    </div>

                    <div class="product-price-card">
                        <div class="price-container">
                            <div class="price-main-new">{{ product.price }}</div>
                            <div class="price-details">
                                <span class="price-label">–¶–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É</span>
                                <span class="price-available">‚úÖ –í –Ω–∞–ª–∏—á–∏–∏</span>
                            </div>
                        </div>
                    </div>

                    <div class="product-description-modern">
                        <div class="description-header">
                            <h3>üìã –û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</h3>
                        </div>
                        <div class="description-content-modern">
                            {{ product.description|default:"–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å. –ú—ã —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞–∂–¥–æ–º —Ç–æ–≤–∞—Ä–µ."|linebreaks }}
                        </div>
                    </div>

                    <div class="product-actions-modern">
                        {% if user.is_authenticated %}
                            <div class="purchase-section">
                                <form method="post" action="{% url 'appProducts:add_to_cart' product.id %}" class="modern-cart-form">
                                    {% csrf_token %}
                                    <div class="quantity-section">
                                        <label class="quantity-label">
                                            <span class="label-icon">üì¶</span>
                                            <span class="label-text">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</span>
                                        </label>
                                        <div class="quantity-controls-modern">
                                            <button type="button" class="qty-btn-modern minus" aria-label="–£–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ">
                                                <span>‚àí</span>
                                            </button>
                                            <input type="number" name="quantity" id="quantity" value="1" min="1" max="100" class="qty-input-modern">
                                            <button type="button" class="qty-btn-modern plus" aria-label="–£–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ">
                                                <span>+</span>
                                            </button>
                                        </div>
                                    </div>
                                    <button type="submit" class="add-to-cart-btn-modern">
                                        <span class="btn-icon">üõí</span>
                                        <span class="btn-text">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</span>
                                        <span class="btn-accent">‚Üí</span>
                                    </button>
                                </form>
                                
                            </div>
                        {% else %}
                            <div class="auth-prompt-modern">
                                <div class="prompt-header">
                                    <h4>üîê –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h4>
                                    <p>–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω—É</p>
                                </div>
                                <div class="auth-actions">
                                    <a href="{% url 'login' %}" class="auth-btn primary">
                                        <span class="btn-icon">üë§</span>
                                        <span class="btn-text">–í–æ–π—Ç–∏</span>
                                    </a>
                                    <a href="{% url 'register' %}" class="auth-btn secondary">
                                        <span class="btn-icon">‚ú®</span>
                                        <span class="btn-text">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</span>
                                    </a>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Å—Ç–∞–≤–∫–µ –∏ –≥–∞—Ä–∞–Ω—Ç–∏—è—Ö -->
        <section class="service-info-section">
            <div class="service-header">
                <h2>üöÄ –°–µ—Ä–≤–∏—Å –∏ –¥–æ—Å—Ç–∞–≤–∫–∞</h2>
                <p>–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º —É–¥–æ–±—Å—Ç–≤–µ</p>
            </div>
            <div class="service-cards">
                <div class="service-card">
                    <div class="service-icon">üöö</div>
                    <div class="service-content">
                        <h4>–ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞</h4>
                        <p>1-3 –¥–Ω—è –ø–æ –≤—Å–µ–π –†–æ—Å—Å–∏–∏</p>
                        <span class="service-detail">–û—Ç 300 ‚ÇΩ –∏–ª–∏ –±–µ—Å–ø–ª–∞—Ç–Ω–æ –æ—Ç 2000 ‚ÇΩ</span>
                    </div>
                </div>
                <div class="service-card">
                    <div class="service-icon">üí≥</div>
                    <div class="service-content">
                        <h4>–£–¥–æ–±–Ω–∞—è –æ–ø–ª–∞—Ç–∞</h4>
                        <p>–õ—é–±—ã–º —É–¥–æ–±–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º</p>
                        <span class="service-detail">–ö–∞—Ä—Ç–∞, –Ω–∞–ª–∏—á–Ω—ã–µ, –æ–Ω–ª–∞–π–Ω –ø–µ—Ä–µ–≤–æ–¥</span>
                    </div>
                </div>
                <div class="service-card">
                    <div class="service-icon">üîÑ</div>
                    <div class="service-content">
                        <h4>–ì–∞—Ä–∞–Ω—Ç–∏—è –≤–æ–∑–≤—Ä–∞—Ç–∞</h4>
                        <p>14 –¥–Ω–µ–π –Ω–∞ –≤–æ–∑–≤—Ä–∞—Ç —Ç–æ–≤–∞—Ä–∞</p>
                        <span class="service-detail">–ë–µ–∑ –ª–∏—à–Ω–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤</span>
                    </div>
                </div>
                <div class="service-card">
                    <div class="service-icon">üéØ</div>
                    <div class="service-content">
                        <h4>–ö–∞—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–∞</h4>
                        <p>–ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–π —Ç–æ–≤–∞—Ä</p>
                        <span class="service-detail">–¢–æ–ª—å–∫–æ —Å–µ—Ä—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- –ü–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã - –ù–æ–≤—ã–π –¥–∏–∑–∞–π–Ω -->
        <section class="related-products-section">
            <div class="container">
                <div class="section-header-modern">
                    <div class="section-title-wrapper">
                        <span class="section-icon">üéØ</span>
                        <h2 class="section-title-modern">–ü–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã</h2>
                    </div>
                    <p class="section-subtitle">–¢–æ–≤–∞—Ä—ã –∏–∑ —Ç–æ–π –∂–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤–∞—Å –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞—Ç—å</p>
                    <div class="section-navigation">
                        <button class="nav-btn prev-btn" onclick="scrollRelatedProducts('left')">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="m15 18-6-6 6-6"/>
                            </svg>
                        </button>
                        <button class="nav-btn next-btn" onclick="scrollRelatedProducts('right')">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="m9 18 6-6-6-6"/>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <div class="related-products-container">
                    <div class="related-products-slider" id="relatedProductsSlider">
                        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ 1 -->
                        <article class="product-card-modern" data-product-id="101">
                            <div class="product-image-container">
                                <div class="product-image-wrapper">
                                    <div class="product-image-placeholder">
                                        <span class="placeholder-emoji">üßΩ</span>
                                    </div>
                                </div>
                                <div class="product-badges">
                                    <span class="product-badge hit">üî• –•–ò–¢</span>
                                </div>
                            </div>
                            
                            <div class="product-content">
                                <div class="product-category-tag">{{ product.subcategory.title }}</div>
                                <h3 class="product-title">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –≥—É–±–∫–∞ –¥–ª—è –º—ã—Ç—å—è –ø–æ—Å—É–¥—ã</h3>
                                
                                <div class="product-rating-modern">
                                    <div class="rating-stars-modern">
                                        <span class="star filled">‚òÖ</span>
                                        <span class="star filled">‚òÖ</span>
                                        <span class="star filled">‚òÖ</span>
                                        <span class="star filled">‚òÖ</span>
                                        <span class="star filled">‚òÖ</span>
                                    </div>
                                    <span class="rating-text">5.0 (24 –æ—Ç–∑—ã–≤–∞)</span>
                                </div>
                                
                                <div class="product-price-container">
                                    <span class="product-price">299 ‚ÇΩ</span>
                                    <span class="price-unit">–∑–∞ —à—Ç.</span>
                                </div>
                                
                                <div class="product-actions">
                                    <button class="add-to-cart-btn" onclick="addToCart(101)">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <circle cx="8" cy="21" r="1"/>
                                            <circle cx="19" cy="21" r="1"/>
                                            <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/>
                                        </svg>
                                        –í –∫–æ—Ä–∑–∏–Ω—É
                                    </button>
                                    <a href="#" class="view-details-btn">
                                        –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="m9 18 6-6-6-6"/>
                                        </svg>
                                    </a>
                                </div>
                            </div>
                        </article>
                        
                        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ 2 -->
                        <article class="product-card-modern" data-product-id="102">
                            <div class="product-image-container">
                                <div class="product-image-wrapper">
                                    <div class="product-image-placeholder">
                                        <span class="placeholder-emoji">üß¥</span>
                                    </div>
                                </div>
                                <div class="product-badges">
                                    <span class="product-badge new">‚ú® –ù–û–í–ò–ù–ö–ê</span>
                                </div>
                            </div>
                            
                            <div class="product-content">
                                <div class="product-category-tag">{{ product.subcategory.title }}</div>
                                <h3 class="product-title">–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ –¥–ª—è —É–±–æ—Ä–∫–∏</h3>
                                
                                <div class="product-rating-modern">
                                    <div class="rating-stars-modern">
                                        <span class="star filled">‚òÖ</span>
                                        <span class="star filled">‚òÖ</span>
                                        <span class="star filled">‚òÖ</span>
                                        <span class="star filled">‚òÖ</span>
                                        <span class="star filled">‚òÖ</span>
                                    </div>
                                    <span class="rating-text">5.0 (18 –æ—Ç–∑—ã–≤–æ–≤)</span>
                                </div>
                                
                                <div class="product-price-container">
                                    <span class="product-price">450 ‚ÇΩ</span>
                                    <span class="price-unit">–∑–∞ —à—Ç.</span>
                                </div>
                                
                                <div class="product-actions">
                                    <button class="add-to-cart-btn" onclick="addToCart(102)">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <circle cx="8" cy="21" r="1"/>
                                            <circle cx="19" cy="21" r="1"/>
                                            <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/>
                                        </svg>
                                        –í –∫–æ—Ä–∑–∏–Ω—É
                                    </button>
                                    <a href="#" class="view-details-btn">
                                        –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="m9 18 6-6-6-6"/>
                                        </svg>
                                    </a>
                                </div>
                            </div>
                        </article>
                        
                        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ 3 -->
                        <article class="product-card-modern" data-product-id="103">
                            <div class="product-image-container">
                                <div class="product-image-wrapper">
                                    <div class="product-image-placeholder">
                                        <span class="placeholder-emoji">üßπ</span>
                                    </div>
                                </div>
                                <div class="product-badges">
                                    <span class="product-badge sale">üí∞ –°–ö–ò–î–ö–ê</span>
                                </div>
                            </div>
                            
                            <div class="product-content">
                                <div class="product-category-tag">{{ product.subcategory.title }}</div>
                                <h3 class="product-title">–®–≤–∞–±—Ä–∞ —Å –º–∏–∫—Ä–æ—Ñ–∏–±—Ä–æ–π –¥–ª—è –∏–¥–µ–∞–ª—å–Ω–æ–π —É–±–æ—Ä–∫–∏</h3>
                                
                                <div class="product-rating-modern">
                                    <div class="rating-stars-modern">
                                        <span class="star filled">‚òÖ</span>
                                        <span class="star filled">‚òÖ</span>
                                        <span class="star filled">‚òÖ</span>
                                        <span class="star filled">‚òÖ</span>
                                        <span class="star">‚òÖ</span>
                                    </div>
                                    <span class="rating-text">4.0 (15 –æ—Ç–∑—ã–≤–æ–≤)</span>
                                </div>
                                
                                <div class="product-price-container">
                                    <span class="product-price-old">890 ‚ÇΩ</span>
                                    <span class="product-price sale">690 ‚ÇΩ</span>
                                    <span class="discount-badge">-22%</span>
                                </div>
                                
                                <div class="product-actions">
                                    <button class="add-to-cart-btn" onclick="addToCart(103)">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <circle cx="8" cy="21" r="1"/>
                                            <circle cx="19" cy="21" r="1"/>
                                            <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/>
                                        </svg>
                                        –í –∫–æ—Ä–∑–∏–Ω—É
                                    </button>
                                    <a href="#" class="view-details-btn">
                                        –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="m9 18 6-6-6-6"/>
                                        </svg>
                                    </a>
                                </div>
                            </div>
                        </article>
                        
                        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ 4 -->
                        <article class="product-card-modern" data-product-id="104">
                            <div class="product-image-container">
                                <div class="product-image-wrapper">
                                    <div class="product-image-placeholder">
                                        <span class="placeholder-emoji">üß§</span>
                                    </div>
                                </div>
                                <div class="product-badges">
                                    <span class="product-badge eco">üå± –≠–ö–û</span>
                                </div>
                            </div>
                            
                            <div class="product-content">
                                <div class="product-category-tag">{{ product.subcategory.title }}</div>
                                <h3 class="product-title">–ü–µ—Ä—á–∞—Ç–∫–∏ –¥–ª—è —É–±–æ—Ä–∫–∏ –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π –ø—Ä–æ—á–Ω–æ—Å—Ç–∏</h3>
                                
                                <div class="product-rating-modern">
                                    <div class="rating-stars-modern">
                                        <span class="star filled">‚òÖ</span>
                                        <span class="star filled">‚òÖ</span>
                                        <span class="star filled">‚òÖ</span>
                                        <span class="star filled">‚òÖ</span>
                                        <span class="star filled">‚òÖ</span>
                                    </div>
                                    <span class="rating-text">5.0 (31 –æ—Ç–∑—ã–≤)</span>
                                </div>
                                
                                <div class="product-price-container">
                                    <span class="product-price">150 ‚ÇΩ</span>
                                    <span class="price-unit">–∑–∞ –ø–∞—Ä—É</span>
                                </div>
                                
                                <div class="product-actions">
                                    <button class="add-to-cart-btn" onclick="addToCart(104)">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <circle cx="8" cy="21" r="1"/>
                                            <circle cx="19" cy="21" r="1"/>
                                            <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/>
                                        </svg>
                                        –í –∫–æ—Ä–∑–∏–Ω—É
                                    </button>
                                    <a href="#" class="view-details-btn">
                                        –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="m9 18 6-6-6-6"/>
                                        </svg>
                                    </a>
                                </div>
                            </div>
                        </article>
                    </div>
                </div>
                
                <div class="section-footer">
                    <a href="{% url 'appProducts:product_list' product.subcategory.category.slug product.subcategory.slug %}" class="view-all-btn-modern">
                        <span class="btn-text">–°–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</span>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="m9 18 6-6-6-6"/>
                        </svg>
                    </a>
                </div>
            </div>
        </section>
    </div>
</div>

<!-- –ú–æ–¥–µ—Ä–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // ===== –°–õ–ê–ô–î–ï–† –ü–û–•–û–ñ–ò–• –¢–û–í–ê–†–û–í =====
    const relatedProductsSlider = document.getElementById('relatedProductsSlider');
    const prevBtn = document.querySelector('.prev-btn');
    const nextBtn = document.querySelector('.next-btn');
    
    if (relatedProductsSlider && prevBtn && nextBtn) {
        const cardWidth = 320 + 24; // —à–∏—Ä–∏–Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ + gap
        let currentPosition = 0;
        const maxScroll = relatedProductsSlider.scrollWidth - relatedProductsSlider.clientWidth;
        
        // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
        function scrollRelatedProducts(direction) {
            const scrollAmount = cardWidth * 2; // –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –Ω–∞ 2 –∫–∞—Ä—Ç–æ—á–∫–∏
            
            if (direction === 'left') {
                currentPosition = Math.max(0, currentPosition - scrollAmount);
            } else {
                currentPosition = Math.min(maxScroll, currentPosition + scrollAmount);
            }
            
            relatedProductsSlider.scrollTo({
                left: currentPosition,
                behavior: 'smooth'
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
            updateNavigationButtons();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–æ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        function updateNavigationButtons() {
            prevBtn.style.opacity = currentPosition <= 0 ? '0.5' : '1';
            prevBtn.style.pointerEvents = currentPosition <= 0 ? 'none' : 'auto';
            
            nextBtn.style.opacity = currentPosition >= maxScroll ? '0.5' : '1';
            nextBtn.style.pointerEvents = currentPosition >= maxScroll ? 'none' : 'auto';
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        prevBtn.addEventListener('click', () => scrollRelatedProducts('left'));
        nextBtn.addEventListener('click', () => scrollRelatedProducts('right'));
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ –º—ã—à—å—é
        relatedProductsSlider.addEventListener('scroll', function() {
            currentPosition = this.scrollLeft;
            updateNavigationButtons();
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        updateNavigationButtons();
        
        // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ touch –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
        let startX = 0;
        let scrollLeft = 0;
        
        relatedProductsSlider.addEventListener('touchstart', function(e) {
            startX = e.touches[0].pageX - this.offsetLeft;
            scrollLeft = this.scrollLeft;
        });
        
        relatedProductsSlider.addEventListener('touchmove', function(e) {
            e.preventDefault();
            const x = e.touches[0].pageX - this.offsetLeft;
            const walk = (x - startX) * 2;
            this.scrollLeft = scrollLeft - walk;
        });
    }
    
    // ===== –ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–´–ï –§–£–ù–ö–¶–ò–ò –¢–û–í–ê–†–û–í =====
    
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É
    window.addToCart = function(productId) {
        const btn = event.target.closest('.add-to-cart-btn');
        const originalText = btn.innerHTML;
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
        btn.innerHTML = '<div class="loading-spinner"></div>–î–æ–±–∞–≤–ª—è–µ–º...';
        btn.disabled = true;
        btn.style.transform = 'scale(0.95)';
        
        // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞
        setTimeout(() => {
            btn.innerHTML = '‚úì –î–æ–±–∞–≤–ª–µ–Ω–æ!';
            btn.style.background = 'linear-gradient(135deg, #10b981, #34d399)';
            
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.disabled = false;
                btn.style.background = 'linear-gradient(135deg, var(--color-primary), var(--color-secondary))';
                btn.style.transform = 'scale(1)';
            }, 2000);
            
            showNotification('–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!', 'success');
        }, 1000);
        
        console.log('–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É:', productId);
    };
    
    // –§—É–Ω–∫—Ü–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    function showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        notification.className = `notification notification-${type}`;
        notification.innerHTML = `
            <div class="notification-content">
                <span class="notification-icon">${type === 'success' ? '‚úì' : type === 'error' ? '‚úó' : '‚Ñπ'}</span>
                <span class="notification-message">${message}</span>
            </div>
        `;
        
        // –°—Ç–∏–ª–∏ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        notification.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: ${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#3b82f6'};
            color: white;
            padding: 16px 20px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            z-index: 10000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            font-weight: 600;
            backdrop-filter: blur(10px);
        `;
        
        document.body.appendChild(notification);
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
        setTimeout(() => {
            notification.style.transform = 'translateX(0)';
        }, 100);
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
        setTimeout(() => {
            notification.style.transform = 'translateX(100%)';
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 300);
        }, 3000);
    }
    
    // –°—Ç–∏–ª–∏ –¥–ª—è —Å–ø–∏–Ω–Ω–µ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏
    const style = document.createElement('style');
    style.textContent = `
        .loading-spinner {
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 8px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .notification-content {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .notification-icon {
            font-weight: bold;
            font-size: 18px;
        }
    `;
    document.head.appendChild(style);

    // Quantity controls
    const qtyInput = document.getElementById('quantity');
    const minusBtn = document.querySelector('.qty-btn-modern.minus');
    const plusBtn = document.querySelector('.qty-btn-modern.plus');
    
    if (minusBtn && plusBtn && qtyInput) {
        // –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –∫–Ω–æ–ø–æ–∫
        function animateButton(btn) {
            btn.style.transform = 'scale(0.95)';
            setTimeout(() => {
                btn.style.transform = 'scale(1)';
            }, 100);
        }
        
        minusBtn.addEventListener('click', function() {
            const currentValue = parseInt(qtyInput.value);
            if (currentValue > 1) {
                qtyInput.value = currentValue - 1;
                animateButton(this);
            }
        });
        
        plusBtn.addEventListener('click', function() {
            const currentValue = parseInt(qtyInput.value);
            if (currentValue < 100) {
                qtyInput.value = currentValue + 1;
                animateButton(this);
            }
        });
        
        // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞
        qtyInput.addEventListener('input', function() {
            let value = parseInt(this.value);
            if (isNaN(value) || value < 1) {
                this.value = 1;
            } else if (value > 100) {
                this.value = 100;
            }
        });
    }
    
    // –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
    const loadingDots = document.querySelectorAll('.loading-dot');
    if (loadingDots.length > 0) {
        loadingDots.forEach((dot, index) => {
            setTimeout(() => {
                setInterval(() => {
                    dot.style.opacity = dot.style.opacity === '0.3' ? '1' : '0.3';
                }, 800);
            }, index * 200);
        });
    }
});
</script>
{% endblock %}