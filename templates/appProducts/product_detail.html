{% extends "base.html" %}
{% load static %}

{% block title %}{{ product.name }} ‚Äî Clean Store{% endblock %}

{% block content %}
<div class="product-detail-page">
    <div class="container">
        <!-- –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏ -->
        <nav class="breadcrumb">
            <a href="{% url 'home' %}" class="breadcrumb-link">–ì–ª–∞–≤–Ω–∞—è</a>
            <span class="breadcrumb-separator">‚Üí</span>
            <a href="{% url 'appProducts:category_list' %}" class="breadcrumb-link">–ö–∞—Ç–∞–ª–æ–≥</a>
            <span class="breadcrumb-separator">‚Üí</span>
            <a href="{% url 'appProducts:subcategory_list' product.subcategory.category.slug %}" class="breadcrumb-link">
                {{ product.subcategory.category.title }}
            </a>
            <span class="breadcrumb-separator">‚Üí</span>
            <a href="{% url 'appProducts:product_list' product.subcategory.category.slug product.subcategory.slug %}" class="breadcrumb-link">
                {{ product.subcategory.title }}
            </a>
            <span class="breadcrumb-separator">‚Üí</span>
            <span class="breadcrumb-current">{{ product.name }}</span>
        </nav>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ -->
        <div class="product-detail-hero">
            <div class="product-hero-content">
                <div class="product-gallery-section">
                    <div class="main-image-container">
                        {% if product.main_image %}
                            <img src="{{ product.main_image.url }}" alt="{{ product.name }}" class="main-product-image">
                        {% else %}
                            <div class="product-image-placeholder">
                                <span class="placeholder-emoji">üßΩ</span>
                                <div class="placeholder-text">
                                    –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
                                    <br><small>—Å–∫–æ—Ä–æ –ø–æ—è–≤–∏—Ç—Å—è</small>
                                </div>
                            </div>
                        {% endif %}
                        
                        <!-- –°—Ç–∏–ª—å–Ω—ã–µ –±–µ–π–¥–∂–∏ -->
                        <div class="product-status-badges">
                            {% if product.is_new %}
                                <span class="status-badge new">
                                    <span class="badge-icon">‚ú®</span>
                                    <span class="badge-text">–ù–æ–≤–∏–Ω–∫–∞</span>
                                </span>
                            {% endif %}
                            {% if product.is_hit %}
                                <span class="status-badge hit">
                                    <span class="badge-icon">üî•</span>
                                    <span class="badge-text">–•–∏—Ç</span>
                                </span>
                            {% endif %}
                            {% if product.is_sale %}
                                <span class="status-badge sale">
                                    <span class="badge-icon">üí∞</span>
                                    <span class="badge-text">–°–∫–∏–¥–∫–∞</span>
                                </span>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- –ì–∞–ª–µ—Ä–µ—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–æ—Ç–æ -->
                    {% if extra_images %}
                        <div class="product-gallery-thumbnails">
                            <h4>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ</h4>
                            <div class="thumbnails-grid">
                                {% for img in extra_images %}
                                    <div class="thumbnail-item">
                                        <img src="{{ img.image.url }}" alt="–§–æ—Ç–æ {{ forloop.counter }}" class="thumbnail-image">
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    {% endif %}
                </div>

                <div class="product-info-section">
                    <div class="product-header-modern">
                        <div class="product-category-path">
                            <span class="category-link">{{ product.subcategory.category.title }}</span>
                            <span class="path-separator">‚Üí</span>
                            <span class="subcategory-link">{{ product.subcategory.title }}</span>
                        </div>
                        <h1 class="product-title-modern">{{ product.name }}</h1>
                    </div>

                    <div class="product-price-card">
                        <div class="price-container">
                            <div class="price-main-new">{{ product.price }}</div>
                            <div class="price-details">
                                <span class="price-label">–¶–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É</span>
                                <span class="price-available">‚úÖ –í –Ω–∞–ª–∏—á–∏–∏</span>
                            </div>
                        </div>
                    </div>

                    <div class="product-description-modern">
                        <div class="description-header">
                            <h3>üìã –û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</h3>
                        </div>
                        <div class="description-content-modern">
                            {{ product.description|default:"–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å. –ú—ã —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞–∂–¥–æ–º —Ç–æ–≤–∞—Ä–µ."|linebreaks }}
                        </div>
                    </div>

                    <div class="product-actions-modern">
                        {% if user.is_authenticated %}
                            <div class="purchase-section">
                                <form method="post" action="{% url 'appProducts:add_to_cart' product.id %}" class="modern-cart-form">
                                    {% csrf_token %}
                                    <div class="quantity-section">
                                        <label class="quantity-label">
                                            <span class="label-icon">üì¶</span>
                                            <span class="label-text">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</span>
                                        </label>
                                        <div class="quantity-controls-modern">
                                            <button type="button" class="qty-btn-modern minus" aria-label="–£–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ">
                                                <span>‚àí</span>
                                            </button>
                                            <input type="number" name="quantity" id="quantity" value="1" min="1" max="100" class="qty-input-modern">
                                            <button type="button" class="qty-btn-modern plus" aria-label="–£–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ">
                                                <span>+</span>
                                            </button>
                                        </div>
                                    </div>
                                    <button type="submit" class="add-to-cart-btn-modern">
                                        <span class="btn-icon">üõí</span>
                                        <span class="btn-text">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</span>
                                        <span class="btn-accent">‚Üí</span>
                                    </button>
                                </form>
                                
                                <div class="secondary-actions">
                                    <button class="action-btn wishlist" onclick="alert('–§—É–Ω–∫—Ü–∏—è –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')" title="–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ">
                                        <span class="action-icon">‚ù§Ô∏è</span>
                                        <span class="action-text">–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
                                    </button>
                                    <button class="action-btn compare" onclick="alert('–§—É–Ω–∫—Ü–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')" title="–î–æ–±–∞–≤–∏—Ç—å –∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é">
                                        <span class="action-icon">‚öñÔ∏è</span>
                                        <span class="action-text">–°—Ä–∞–≤–Ω–∏—Ç—å</span>
                                    </button>
                                </div>
                            </div>
                        {% else %}
                            <div class="auth-prompt-modern">
                                <div class="prompt-header">
                                    <h4>üîê –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h4>
                                    <p>–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω—É</p>
                                </div>
                                <div class="auth-actions">
                                    <a href="{% url 'login' %}" class="auth-btn primary">
                                        <span class="btn-icon">üë§</span>
                                        <span class="btn-text">–í–æ–π—Ç–∏</span>
                                    </a>
                                    <a href="{% url 'register' %}" class="auth-btn secondary">
                                        <span class="btn-icon">‚ú®</span>
                                        <span class="btn-text">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</span>
                                    </a>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Å—Ç–∞–≤–∫–µ –∏ –≥–∞—Ä–∞–Ω—Ç–∏—è—Ö -->
        <section class="service-info-section">
            <div class="service-header">
                <h2>üöÄ –°–µ—Ä–≤–∏—Å –∏ –¥–æ—Å—Ç–∞–≤–∫–∞</h2>
                <p>–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–∞—à–µ–º —É–¥–æ–±—Å—Ç–≤–µ</p>
            </div>
            <div class="service-cards">
                <div class="service-card">
                    <div class="service-icon">üöö</div>
                    <div class="service-content">
                        <h4>–ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞</h4>
                        <p>1-3 –¥–Ω—è –ø–æ –≤—Å–µ–π –†–æ—Å—Å–∏–∏</p>
                        <span class="service-detail">–û—Ç 300 ‚ÇΩ –∏–ª–∏ –±–µ—Å–ø–ª–∞—Ç–Ω–æ –æ—Ç 2000 ‚ÇΩ</span>
                    </div>
                </div>
                <div class="service-card">
                    <div class="service-icon">üí≥</div>
                    <div class="service-content">
                        <h4>–£–¥–æ–±–Ω–∞—è –æ–ø–ª–∞—Ç–∞</h4>
                        <p>–õ—é–±—ã–º —É–¥–æ–±–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º</p>
                        <span class="service-detail">–ö–∞—Ä—Ç–∞, –Ω–∞–ª–∏—á–Ω—ã–µ, –æ–Ω–ª–∞–π–Ω –ø–µ—Ä–µ–≤–æ–¥</span>
                    </div>
                </div>
                <div class="service-card">
                    <div class="service-icon">üîÑ</div>
                    <div class="service-content">
                        <h4>–ì–∞—Ä–∞–Ω—Ç–∏—è –≤–æ–∑–≤—Ä–∞—Ç–∞</h4>
                        <p>14 –¥–Ω–µ–π –Ω–∞ –≤–æ–∑–≤—Ä–∞—Ç —Ç–æ–≤–∞—Ä–∞</p>
                        <span class="service-detail">–ë–µ–∑ –ª–∏—à–Ω–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤</span>
                    </div>
                </div>
                <div class="service-card">
                    <div class="service-icon">üéØ</div>
                    <div class="service-content">
                        <h4>–ö–∞—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–∞</h4>
                        <p>–ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–π —Ç–æ–≤–∞—Ä</p>
                        <span class="service-detail">–¢–æ–ª—å–∫–æ —Å–µ—Ä—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- –ü–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã -->
        <section class="related-products-modern">
            <div class="related-header">
                <h2>üí° –ü–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã</h2>
                <p>–¢–æ–≤–∞—Ä—ã –∏–∑ —Ç–æ–π –∂–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤–∞—Å –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞—Ç—å</p>
            </div>
            
            <div class="related-products-grid">
                <!-- –ú–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Ö–æ–∂–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤ -->
                <div class="related-product-card" data-product-id="101">
                    <div class="related-product-image">
                        <div class="product-image-placeholder">
                            <span class="placeholder-emoji">üßΩ</span>
                        </div>
                        <div class="related-product-badges">
                            <span class="related-badge hit">üî• –•–ò–¢</span>
                        </div>
                        <div class="related-product-actions">
                            <button class="related-action-btn wishlist" onclick="toggleWishlist(101, this)" title="–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ">‚ù§Ô∏è</button>
                            <button class="related-action-btn compare" onclick="toggleCompare(101, this)" title="–°—Ä–∞–≤–Ω–∏—Ç—å">‚öñÔ∏è</button>
                        </div>
                    </div>
                    <div class="related-product-info">
                        <h4 class="related-product-name">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –≥—É–±–∫–∞ –¥–ª—è –º—ã—Ç—å—è –ø–æ—Å—É–¥—ã</h4>
                        <p class="related-product-category">{{ product.subcategory.title }}</p>
                        <div class="related-product-price">299 ‚ÇΩ</div>
                        <div class="related-product-rating">
                            <div class="rating-stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                            <span class="rating-count">(24)</span>
                        </div>
                        <a href="#" class="related-product-link">
                            <span class="link-text">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</span>
                            <span class="link-arrow">‚Üí</span>
                        </a>
                    </div>
                </div>
                
                <div class="related-product-card" data-product-id="102">
                    <div class="related-product-image">
                        <div class="product-image-placeholder">
                            <span class="placeholder-emoji">üß¥</span>
                        </div>
                        <div class="related-product-badges">
                            <span class="related-badge new">‚ú® –ù–û–í–ò–ù–ö–ê</span>
                        </div>
                        <div class="related-product-actions">
                            <button class="related-action-btn wishlist" onclick="toggleWishlist(102, this)" title="–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ">‚ù§Ô∏è</button>
                            <button class="related-action-btn compare" onclick="toggleCompare(102, this)" title="–°—Ä–∞–≤–Ω–∏—Ç—å">‚öñÔ∏è</button>
                        </div>
                    </div>
                    <div class="related-product-info">
                        <h4 class="related-product-name">–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ –¥–ª—è —É–±–æ—Ä–∫–∏</h4>
                        <p class="related-product-category">{{ product.subcategory.title }}</p>
                        <div class="related-product-price">450 ‚ÇΩ</div>
                        <div class="related-product-rating">
                            <div class="rating-stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                            <span class="rating-count">(18)</span>
                        </div>
                        <a href="#" class="related-product-link">
                            <span class="link-text">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</span>
                            <span class="link-arrow">‚Üí</span>
                        </a>
                    </div>
                </div>
                
                <div class="related-product-card" data-product-id="103">
                    <div class="related-product-image">
                        <div class="product-image-placeholder">
                            <span class="placeholder-emoji">üßπ</span>
                        </div>
                        <div class="related-product-badges">
                            <span class="related-badge sale">üí∞ –°–ö–ò–î–ö–ê</span>
                        </div>
                        <div class="related-product-actions">
                            <button class="related-action-btn wishlist" onclick="toggleWishlist(103, this)" title="–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ">‚ù§Ô∏è</button>
                            <button class="related-action-btn compare" onclick="toggleCompare(103, this)" title="–°—Ä–∞–≤–Ω–∏—Ç—å">‚öñÔ∏è</button>
                        </div>
                    </div>
                    <div class="related-product-info">
                        <h4 class="related-product-name">–®–≤–∞–±—Ä–∞ —Å –º–∏–∫—Ä–æ—Ñ–∏–±—Ä–æ–π –¥–ª—è –∏–¥–µ–∞–ª—å–Ω–æ–π —É–±–æ—Ä–∫–∏</h4>
                        <p class="related-product-category">{{ product.subcategory.title }}</p>
                        <div class="related-product-price">
                            <span class="price-old">890 ‚ÇΩ</span>
                            <span class="price-current">690 ‚ÇΩ</span>
                        </div>
                        <div class="related-product-rating">
                            <div class="rating-stars">‚≠ê‚≠ê‚≠ê‚≠ê</div>
                            <span class="rating-count">(12)</span>
                        </div>
                        <a href="#" class="related-product-link">
                            <span class="link-text">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</span>
                            <span class="link-arrow">‚Üí</span>
                        </a>
                    </div>
                </div>
                
                <div class="related-product-card" data-product-id="104">
                    <div class="related-product-image">
                        <div class="product-image-placeholder">
                            <span class="placeholder-emoji">üß§</span>
                        </div>
                        <div class="related-product-actions">
                            <button class="related-action-btn wishlist" onclick="toggleWishlist(104, this)" title="–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ">‚ù§Ô∏è</button>
                            <button class="related-action-btn compare" onclick="toggleCompare(104, this)" title="–°—Ä–∞–≤–Ω–∏—Ç—å">‚öñÔ∏è</button>
                        </div>
                    </div>
                    <div class="related-product-info">
                        <h4 class="related-product-name">–ü–µ—Ä—á–∞—Ç–∫–∏ –¥–ª—è —É–±–æ—Ä–∫–∏ –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π –ø—Ä–æ—á–Ω–æ—Å—Ç–∏</h4>
                        <p class="related-product-category">{{ product.subcategory.title }}</p>
                        <div class="related-product-price">150 ‚ÇΩ</div>
                        <div class="related-product-rating">
                            <div class="rating-stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                            <span class="rating-count">(31)</span>
                        </div>
                        <a href="#" class="related-product-link">
                            <span class="link-text">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</span>
                            <span class="link-arrow">‚Üí</span>
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="related-footer">
                <a href="{% url 'appProducts:product_list' product.subcategory.category.slug product.subcategory.slug %}" class="view-all-related">
                    <span class="view-all-text">–°–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</span>
                    <span class="view-all-arrow">‚Üí</span>
                </a>
            </div>
        </section>
    </div>
</div>

<!-- –ú–æ–¥–µ—Ä–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Quantity controls
    const qtyInput = document.getElementById('quantity');
    const minusBtn = document.querySelector('.qty-btn-modern.minus');
    const plusBtn = document.querySelector('.qty-btn-modern.plus');
    
    if (minusBtn && plusBtn && qtyInput) {
        // –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –∫–Ω–æ–ø–æ–∫
        function animateButton(btn) {
            btn.style.transform = 'scale(0.95)';
            setTimeout(() => {
                btn.style.transform = 'scale(1)';
            }, 100);
        }
        
        minusBtn.addEventListener('click', function() {
            const currentValue = parseInt(qtyInput.value);
            if (currentValue > 1) {
                qtyInput.value = currentValue - 1;
                animateButton(this);
            }
        });
        
        plusBtn.addEventListener('click', function() {
            const currentValue = parseInt(qtyInput.value);
            if (currentValue < 100) {
                qtyInput.value = currentValue + 1;
                animateButton(this);
            }
        });
        
        // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞
        qtyInput.addEventListener('input', function() {
            let value = parseInt(this.value);
            if (isNaN(value) || value < 1) {
                this.value = 1;
            } else if (value > 100) {
                this.value = 100;
            }
        });
    }
    
    // –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
    const loadingDots = document.querySelectorAll('.loading-dot');
    if (loadingDots.length > 0) {
        loadingDots.forEach((dot, index) => {
            setTimeout(() => {
                setInterval(() => {
                    dot.style.opacity = dot.style.opacity === '0.3' ? '1' : '0.3';
                }, 800);
            }, index * 200);
        });
    }
});
</script>
{% endblock %}