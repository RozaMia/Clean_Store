{% extends "base.html" %}
{% load static %}

{% block title %}{{ product.name }} ‚Äî Clean Store{% endblock %}

{% block content %}
<div class="product-detail-page">
    <div class="container">
        <!-- –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏ -->
        <nav class="breadcrumb">
            <a href="{% url 'home' %}" class="breadcrumb-link">–ì–ª–∞–≤–Ω–∞—è</a>
            <span class="breadcrumb-separator">‚Üí</span>
            <a href="{% url 'appProducts:category_list' %}" class="breadcrumb-link">–ö–∞—Ç–∞–ª–æ–≥</a>
            <span class="breadcrumb-separator">‚Üí</span>
            <a href="{% url 'appProducts:subcategory_list' product.subcategory.category.slug %}" class="breadcrumb-link">
                {{ product.subcategory.category.title }}
            </a>
            <span class="breadcrumb-separator">‚Üí</span>
            <a href="{% url 'appProducts:product_list' product.subcategory.category.slug product.subcategory.slug %}" class="breadcrumb-link">
                {{ product.subcategory.title }}
            </a>
            <span class="breadcrumb-separator">‚Üí</span>
            <span class="breadcrumb-current">{{ product.name }}</span>
        </nav>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ -->
        <div class="product-detail-card">
            <div class="product-gallery">
                <div class="main-image-container">
                    {% if product.main_image %}
                        <img src="{{ product.main_image.url }}" alt="{{ product.name }}" class="main-image">
                    {% else %}
                        <div class="image-placeholder main">üßΩ</div>
                    {% endif %}
                    
                    <!-- –ë–µ–π–¥–∂–∏ -->
                    <div class="product-badges">
                        {% if product.is_new %}
                            <span class="badge new">NEW</span>
                        {% endif %}
                        {% if product.is_hit %}
                            <span class="badge hit">–•–ò–¢</span>
                        {% endif %}
                        {% if product.is_sale %}
                            <span class="badge sale">–°–ö–ò–î–ö–ê</span>
                        {% endif %}
                    </div>
                </div>
                
                <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ -->
                {% if extra_images %}
                    <div class="extra-images">
                        {% for img in extra_images %}
                            <div class="extra-image-container">
                                <img src="{{ img.image.url }}" alt="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ñ–æ—Ç–æ {{ forloop.counter }}" class="extra-image">
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>

            <div class="product-info">
                <div class="product-header">
                    <h1 class="product-title">{{ product.name }}</h1>
                    <div class="product-category">
                        {{ product.subcategory.category.title }} ‚Üí {{ product.subcategory.title }}
                    </div>
                </div>

                <div class="product-price-section">
                    <div class="price-main">{{ product.price }}</div>
                    <div class="price-info">–¶–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É —Ç–æ–≤–∞—Ä–∞</div>
                </div>

                <div class="product-description">
                    <h3>–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</h3>
                    <div class="description-content">
                        {{ product.description|default:"–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å."|linebreaks }}
                    </div>
                </div>

                <div class="product-actions">
                    {% if user.is_authenticated %}
                        <form method="post" action="{% url 'appProducts:add_to_cart' product.id %}" class="add-to-cart-form">
                            {% csrf_token %}
                            <div class="quantity-selector">
                                <label for="quantity">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</label>
                                <div class="quantity-controls">
                                    <button type="button" class="qty-btn minus">-</button>
                                    <input type="number" name="quantity" id="quantity" value="1" min="1" max="100" class="qty-input">
                                    <button type="button" class="qty-btn plus">+</button>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary btn-lg add-to-cart-btn">
                                üõí –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É
                            </button>
                        </form>
                        
                        <div class="additional-actions">
                            <button class="btn btn-secondary btn-outline" onclick="alert('–§—É–Ω–∫—Ü–∏—è –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">
                                ‚ù§Ô∏è –í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
                            </button>
                            <button class="btn btn-secondary btn-outline" onclick="alert('–§—É–Ω–∫—Ü–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">
                                ‚öñÔ∏è –°—Ä–∞–≤–Ω–∏—Ç—å
                            </button>
                        </div>
                    {% else %}
                        <div class="login-prompt">
                            <p>–î–ª—è –ø–æ–∫—É–ø–∫–∏ —Ç–æ–≤–∞—Ä–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç</p>
                            <div class="login-actions">
                                <a href="{% url 'login' %}" class="btn btn-primary btn-lg">
                                    üë§ –í–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç
                                </a>
                                <a href="{% url 'register' %}" class="btn btn-secondary">
                                    ‚ú® –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
                                </a>
                            </div>
                        </div>
                    {% endif %}
                </div>

                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Å—Ç–∞–≤–∫–µ -->
                <div class="delivery-info">
                    <h3>–î–æ—Å—Ç–∞–≤–∫–∞ –∏ –æ–ø–ª–∞—Ç–∞</h3>
                    <div class="delivery-options">
                        <div class="delivery-option">
                            <span class="delivery-icon">üöö</span>
                            <div class="delivery-text">
                                <strong>–ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞</strong>
                                <p>1-3 –¥–Ω—è –ø–æ –†–æ—Å—Å–∏–∏</p>
                            </div>
                        </div>
                        <div class="delivery-option">
                            <span class="delivery-icon">üí≥</span>
                            <div class="delivery-text">
                                <strong>–£–¥–æ–±–Ω–∞—è –æ–ø–ª–∞—Ç–∞</strong>
                                <p>–ö–∞—Ä—Ç–∞, –Ω–∞–ª–∏—á–Ω—ã–µ, –ø–µ—Ä–µ–≤–æ–¥</p>
                            </div>
                        </div>
                        <div class="delivery-option">
                            <span class="delivery-icon">üîÑ</span>
                            <div class="delivery-text">
                                <strong>–ì–∞—Ä–∞–Ω—Ç–∏—è –≤–æ–∑–≤—Ä–∞—Ç–∞</strong>
                                <p>14 –¥–Ω–µ–π –Ω–∞ –≤–æ–∑–≤—Ä–∞—Ç</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ü–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã -->
        <section class="related-products">
            <h2 class="section-title">–ü–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã</h2>
            <div class="related-placeholder">
                <div class="placeholder-icon">üîç</div>
                <p>–ü–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å</p>
            </div>
        </section>
    </div>
</div>

<!-- JavaScript –¥–ª—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const qtyInput = document.getElementById('quantity');
    const minusBtn = document.querySelector('.qty-btn.minus');
    const plusBtn = document.querySelector('.qty-btn.plus');
    
    if (minusBtn && plusBtn && qtyInput) {
        minusBtn.addEventListener('click', function() {
            const currentValue = parseInt(qtyInput.value);
            if (currentValue > 1) {
                qtyInput.value = currentValue - 1;
            }
        });
        
        plusBtn.addEventListener('click', function() {
            const currentValue = parseInt(qtyInput.value);
            if (currentValue < 100) {
                qtyInput.value = currentValue + 1;
            }
        });
    }
});
</script>
{% endblock %}